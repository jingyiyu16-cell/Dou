<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACCESS | RHYTHM</title>
    
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&family=Space+Mono&display=swap" rel="stylesheet">
    <!-- å¼•å…¥ RemixIcon ç”¨äºèŠ¯ç‰‡å›¾æ ‡ -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <style>
        :root { --bg: #080808; --text: #e0e0e0; --accent: #fff; --gold: #e6b000; }
        body { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; height: 100vh; display: flex; flex-direction: column; cursor: none; overflow: hidden; }
        a { text-decoration: none; color: inherit; cursor: none; }
        
        .noise { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; opacity: 0.05; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E"); }
        .cursor { position: fixed; width: 10px; height: 10px; background: #fff; border-radius: 50%; transform: translate(-50%, -50%); pointer-events: none; z-index: 9999; mix-blend-mode: difference; }

        nav { padding: 2rem 4rem; display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 10; height: 10vh; }
        .logo { font-family: 'Cinzel'; font-weight: 700; font-size: 1.5rem; }
        .back-link { font-family: 'Space Mono'; font-size: 0.8rem; opacity: 0.6; transition: 0.3s; }
        .back-link:hover { opacity: 1; letter-spacing: 1px; }

        /* ä¸»å¸ƒå±€ */
        .container { flex: 1; display: flex; align-items: center; justify-content: space-around; width: 90%; max-width: 1600px; margin: 0 auto; position: relative; z-index: 5; }

        /* å·¦ä¾§ä¿¡æ¯ (ä¿æŒä¸å˜) */
        .info-side { width: 45%; display: flex; flex-direction: column; justify-content: center; }
        .page-title { font-family: 'Cinzel'; font-size: 5vw; line-height: 1; margin-bottom: 3rem; background: linear-gradient(to right, #fff, #666); -webkit-background-clip: text; color: transparent; }
        .info-block { margin-bottom: 2.5rem; border-left: 1px solid #333; padding-left: 1.5rem; }
        .label { font-family: 'Space Mono'; color: #666; font-size: 0.8rem; margin-bottom: 0.8rem; display: block; letter-spacing: 1px;}
        .value { font-size: 1.4rem; font-weight: 300; color: #ddd; line-height: 1.4; }
        .text-btn { font-family: 'Space Mono'; font-size: 0.9rem; color: #fff; border-bottom: 1px solid #444; padding-bottom: 5px; transition: 0.3s; display: inline-block; margin-top: 0.5rem; cursor: none; }
        .text-btn:hover { border-color: #fff; color: var(--accent); }

        /* ================= å³ä¾§ï¼šå…¨æ–°æ¨ªç‰ˆå¡ç‰‡ ================= */
        .card-side { width: 45%; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; z-index: 20; }

        .holo-pass {
            width: 540px; height: 320px; /* æ¨ªç‰ˆé»„é‡‘æ¯”ä¾‹ */
            background: linear-gradient(135deg, #1a1a1a, #050505);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 16px;
            display: flex; overflow: hidden;
            box-shadow: 0 30px 70px rgba(0,0,0,0.6);
            position: relative;
            backdrop-filter: blur(20px);
            transform-style: preserve-3d;
            margin-bottom: 3rem;
        }

        /* å·¦åŠéƒ¨åˆ†ï¼šæ‰«æåŒº */
        .pass-left {
            width: 180px; background: #111; border-right: 1px dashed #333;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; position: relative;
        }
        .qr-box {
            width: 120px; height: 120px; background: #fff; padding: 5px; border-radius: 4px;
            margin-bottom: 1rem;
        }
        .qr-box img { width: 100%; height: 100%; display: block; }
        .scan-hint { font-family: 'Space Mono'; font-size: 0.6rem; color: #666; text-orientation: sideways; letter-spacing: 2px; }
        
        /* è£…é¥°æ€§å…¨æ¯æ¡ */
        .holo-strip {
            position: absolute; left: 0; top: 20px; width: 4px; height: 40px; background: var(--gold);
            box-shadow: 0 0 10px var(--gold);
        }

        /* å³åŠéƒ¨åˆ†ï¼šä¿¡æ¯åŒº */
        .pass-right {
            flex: 1; padding: 2rem; display: flex; flex-direction: column; justify-content: space-between;
            position: relative;
        }
        
        /* é¡¶éƒ¨ï¼šèŠ¯ç‰‡ä¸Logo */
        .pass-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .chip-icon { font-size: 2rem; color: #d4af37; opacity: 0.8; }
        .brand-mark { text-align: right; }
        .brand-name { font-family: 'Cinzel'; font-weight: bold; font-size: 1.2rem; display: block; }
        .brand-tag { font-family: 'Space Mono'; font-size: 0.6rem; border: 1px solid #fff; padding: 2px 6px; border-radius: 4px; }

        /* ä¸­éƒ¨ï¼šç”¨æˆ·ä¿¡æ¯ */
        .pass-body { margin-top: 1rem; }
        .field-label { font-family: 'Space Mono'; font-size: 0.6rem; color: #666; margin-bottom: 4px; display: block;}
        .user-name { 
            font-family: 'Cinzel'; font-size: 2rem; color: #fff; 
            text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            width: 300px;
        }
        .user-id { font-family: 'Space Mono'; color: var(--gold); font-size: 0.8rem; letter-spacing: 1px; margin-top: 5px; }

        /* åº•éƒ¨ï¼šå…ƒæ•°æ® */
        .pass-footer {
            display: flex; justify-content: space-between; border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 10px; font-family: 'Space Mono'; font-size: 0.6rem; color: #888;
        }

        /* å…‰æ³½ç‰¹æ•ˆ */
        .shine {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(115deg, transparent 40%, rgba(255,255,255,0.05) 45%, transparent 50%);
            pointer-events: none;
        }

        /* è¾“å…¥æ§ä»¶ (ç»å¯¹ç½®é¡¶) */
        .controls { width: 400px; display: flex; gap: 10px; position: relative; z-index: 100; }
        input {
            flex: 1; background: transparent; border: none; border-bottom: 1px solid #444; 
            color: #fff; padding: 10px; font-family: 'Space Mono'; font-size: 0.9rem; 
            outline: none; transition: 0.3s; cursor: text !important; pointer-events: auto !important; 
        }
        input:focus { border-bottom-color: #fff; }
        .btn { 
            background: #fff; color: #000; border: none; padding: 10px 25px; 
            font-family: 'Space Mono'; font-size: 0.8rem; font-weight: 600; 
            transition: 0.3s; cursor: pointer !important; pointer-events: auto !important;
        }
        .btn:hover { background: #ccc; }
        .msg { margin-top: 10px; font-family: 'Space Mono'; font-size: 0.7rem; color: #666; height: 1rem; text-align: center; }

        @media(max-width: 900px) {
            .container { flex-direction: column; justify-content: flex-start; padding: 2rem; }
            .info-side, .card-side { width: 100%; }
            .holo-pass { width: 100%; max-width: 400px; height: auto; flex-direction: column; }
            .pass-left { width: 100%; border-right: none; border-bottom: 1px dashed #333; flex-direction: row; justify-content: space-between; padding: 15px; }
            .qr-box { margin-bottom: 0; width: 80px; height: 80px; }
            .pass-right { padding: 1.5rem; }
            .controls { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="noise"></div>
    <div class="cursor"></div>

    <nav>
        <a href="index.html" class="back-link hover-trigger">â† BACK TO HOME</a>
        <div class="logo">RHYTHM.</div>
    </nav>

    <div class="container">
        
        <!-- å·¦ä¾§ï¼šå±•è§ˆä¿¡æ¯ (ä¿æŒä¸å˜) -->
        <div class="info-side">
            <h1 class="page-title">Digital<br>Admission</h1>
            
            <div class="info-block">
                <span class="label">VENUE / åœºé¦†</span>
                <div class="value">
                   ZJNU Art Center, Hall A<br>
                    <span style="font-size: 0.9rem; color: #888;">æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦å©ºåŸåŒºè¿å®¾å¤§é“688å·</span>
                </div>
                <a href="https://www.amap.com/search?query=æµ™æ±Ÿå¸ˆèŒƒå¤§å­¦" target="_blank" class="text-btn hover-trigger">
                    ğŸ“ Open in Amap (é«˜å¾·åœ°å›¾)
                </a>
            </div>
            
            <div class="info-block">
                <span class="label">SCHEDULE / å±•æœŸ</span>
                <div class="value">Oct 15 â€” Nov 30, 2026<br>10:00 AM â€” 08:00 PM (å‘¨ä¸€é—­å±•)</div>
            </div>

            <div class="info-block">
                <span class="label">INQUIRY / å®˜æ–¹è”ç»œ</span>
                <div class="value" style="margin-bottom: 0.5rem;">RHYTHM Studio Office</div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a href="tel:037119558257559" class="text-btn hover-trigger">ğŸ“ 0371-19558257559</a>
                    <span class="text-btn" style="cursor: default; border-bottom: none; color: #aaa;">ğŸ’¬ WeChatï¼šErdou</span>
                </div>
            </div>
        </div>

        <!-- å³ä¾§ï¼šå…¨æ–°çš„æ¨ªç‰ˆå¡ç‰‡ -->
        <div class="card-side">
            <div style="perspective: 1000px;">
                <div class="holo-pass" id="capture-area">
                    <div class="shine"></div>
                    <div class="holo-strip"></div>
                    
                    <!-- å·¦ä¾§ï¼šæ‰«ç åŒº -->
                    <div class="pass-left">
                        <div class="qr-box">
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=RHYTHM" class="qr-img" alt="QR">
                        </div>
                        <span class="scan-hint">SCAN FOR GUIDE</span>
                    </div>

                    <!-- å³ä¾§ï¼šæ•°æ®åŒº -->
                    <div class="pass-right">
                        <div class="pass-header">
                            <i class="ri-sim-card-2-line chip-icon"></i> <!-- æ¨¡æ‹ŸèŠ¯ç‰‡ -->
                            <div class="brand-mark">
                                <span class="brand-name">RHYTHM.</span>
                                <span class="brand-tag">VIP PASS</span>
                            </div>
                        </div>

                        <div class="pass-body">
                            <span class="field-label">AUTHORIZED VISITOR</span>
                            <div class="user-name" id="displayName">YOUR NAME</div>
                            <div class="user-id" id="displayID">ID: WAITING_INPUT</div>
                        </div>

                        <div class="pass-footer">
                            <span>ZJNU ART CENTER</span>
                            <span>CN-2026</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ§åˆ¶åŒº -->
            <div class="controls">
                <input type="text" id="nameInput" placeholder="ENTER YOUR NAME" maxlength="15" autocomplete="off">
                <button class="btn hover-trigger" id="genBtn">GENERATE</button>
            </div>
            <div class="msg" id="msg">Create your digital access badge</div>
        </div>
    </div>

    <script>
        // ================= 1. é¼ æ ‡é€»è¾‘ =================
        const cursor = document.querySelector('.cursor');
        window.addEventListener('mousemove', (e) => gsap.set(cursor, { x: e.clientX, y: e.clientY }));
        
        const hoverEls = document.querySelectorAll('.hover-trigger, a, button');
        hoverEls.forEach(el => {
            el.addEventListener('mouseenter', () => gsap.to(cursor, { scale: 3, opacity: 0.3, duration: 0.2 }));
            el.addEventListener('mouseleave', () => gsap.to(cursor, { scale: 1, opacity: 1, duration: 0.2 }));
        });

        const input = document.getElementById('nameInput');
        input.addEventListener('mouseenter', () => gsap.to(cursor, { opacity: 0, scale: 0 }));
        input.addEventListener('mouseleave', () => gsap.to(cursor, { opacity: 1, scale: 1 }));

        // ================= 2. å¡ç‰‡å¾®åŠ¨æ•ˆ =================
        const card = document.querySelector('.holo-pass');
        const cardSide = document.querySelector('.card-side');

        cardSide.addEventListener('mousemove', (e) => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') return;
            const rect = card.getBoundingClientRect(); 
            const x = e.clientX - (rect.left + rect.width/2);
            const y = e.clientY - (rect.top + rect.height/2);
            
            gsap.to(card, {
                rotationY: x * 0.03, // é™ä½æ—‹è½¬å¹…åº¦ï¼Œæ›´ç¨³é‡
                rotationX: -y * 0.03,
                duration: 0.1,
                ease: "power1.out"
            });
        });
        cardSide.addEventListener('mouseleave', () => {
            gsap.to(card, { rotationY: 0, rotationX: 0, duration: 0.5, ease: "power2.out" });
        });

        // ================= 3. é€»è¾‘åŠŸèƒ½ =================
        const btn = document.getElementById('genBtn');
        const displayName = document.getElementById('displayName');
        const displayID = document.getElementById('displayID');
        const msg = document.getElementById('msg');
        const qrImg = document.querySelector('.qr-img');
        
        let isGenerated = false;

        btn.addEventListener('click', () => {
            if(!input.value) {
                msg.innerText = "Name is required.";
                msg.style.color = "red";
                return;
            }

            if(!isGenerated) {
                // ç”Ÿæˆæ•°æ®
                const userName = input.value;
                const userId = Math.floor(Math.random() * 90000 + 10000) + "-VIP";

                displayName.innerText = userName;
                displayID.innerText = "ID: " + userId;
                
                // åŠ¨æ€äºŒç»´ç 
                const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
                const welcomeUrl = `${baseUrl}welcome.html?n=${encodeURIComponent(userName)}&i=${encodeURIComponent(userId)}`;
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(welcomeUrl)}`;

                msg.innerText = "Badge Ready. Download to save.";
                msg.style.color = "#888";
                btn.innerText = "DOWNLOAD";
                
                // é«˜å…‰åŠ¨ç”»
                gsap.fromTo(card, { filter: "brightness(1)" }, { filter: "brightness(1.3)", duration: 0.1, yoyo: true, repeat: 1 });
                isGenerated = true;
            } else {
                // ä¸‹è½½å›¾ç‰‡
                msg.innerText = "Processing...";
                gsap.set(card, { rotationX: 0, rotationY: 0 }); // å½’ä½

                setTimeout(() => {
                    html2canvas(document.getElementById('capture-area'), {
                        backgroundColor: null,
                        scale: 2,
                        useCORS: true
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = `RHYTHM_BADGE_${input.value}.png`;
                        link.href = canvas.toDataURL();
                        link.click();
                        msg.innerText = "Saved to device.";
                    });
                }, 50);
            }
        });
    </script>
</body>
</html>